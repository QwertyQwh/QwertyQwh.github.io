<!DOCTYPE HTML>

<html>
	<head>
		<title>HMarch</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../../assets/css/main.css" />
	</head>
	<body class="single is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
				<header id="header">
					<h1><a href="../../index.html#banner">Weihang Qin</a></h1>
					<nav class="links">
						<ul>
							<li><a href="../../babble/babble.html">Babble</a></li>
							<li><a href="../../doodle/doodle.html">Doodle</a></li>
							<li><a href="../code.html">Code</a></li>
							<li><a href="../../play/play.html">Play</a></li>
							<li><a href="../../jumble/jumble.html">Jumble</a></li>
						</ul>
					</nav>
					<nav class="main">
						<ul>

							<li class="menu">
								<a class="fa-bars" href="#menu">Menu</a>
							</li>
						</ul>
					</nav>
				</header>




<section id="menu">

<!-- Search -->
	<section>
		<form class="search" method="get" action="#">
			<input type="text" name="query" placeholder="Search" />
		</form>
	</section>

<!-- Links -->
	<section>
		<ul class="links">
			<li><a href="../../babble/babble.html#banner"><h2>Babble</h2></a></li>
			<li><a href="../../doodle/doodle.html"><h2>Doodle</h2></a></li>
			<li><a href="../code.html#banner"><h2>Code</h2></a></li>
			<li><a href="../../play/play.html#banner"><h2>Play</h2></a></li>
			<li><a href="../../jumble/jumble.html"><h2>Jumble</h2></a></li>
		</ul>
	</section>
	


			</section>


				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<article class="post">
								<header>
									<div class="title">
										<h2><a href="#">Go Hyperbolic</a><br />
											<a href="#">双曲空间旅行</a></h2>
										<p>Search "Hyperbolic crochet"<br />
										   搜搜看 “双曲钩针编织”</p>

									</div>
									<div class="meta">
										<time class="published" datetime="2019-1-22"> April 30 2021 </time>
										<a href="../../postsByColor/ColorChart.html" class="author"><span class="name">Lemon Green</span><img src="../../images/lemonGreen.jpg" alt="" /></a>
									</div>
								</header>
								<span class="image featured"><img src="images/code_graphics_hyperbolic_raymarching/featured.png" alt="" /> <Credit>Image: Behold the hyperbolic eye of mordor</Credit></span>

<p> This post is a brief introduction to visualizing hyperbolic space. You'll find a link to my github sources at the end.</p>

								<p> To understand what a hyperbolic space is, we define both the <bold>space</bold> and the <bold>distances</bold> slightly differently from its usual Euclidean notion. I sometimes like to think of it as a 'crumpled' space. </p>
	
<p>For some intuition, on the left are three "straight lines" on a shiny Euclidean paper. On the right, are the correponding "straight" lines on a Hyperbolic paper. </p>
								<div class="box alt">
									<div class="row gtr-uniform">
										<div class="col-6"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/webHyper1.png" alt="" /></span></div>
										<div class="col-6"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/webHyper2.png" alt="" /></span></div>
									</div>
								</div>



								<p> Next we are going a minimal tour in the Math Realm. Don't panic. It won't hurt a bit. </p>


								<infobox>						
									<p>Let \(k\) denote a field of characteristics different from 2 and \(E\) a vector space over \(k\) of finite dimension \(n\).  A <bold>quadratic form</bold>  on \(E\) is a function \(Q: E\to k\) homogeneous of degree 2, i.e.
									
									$$Q(\lambda z) = \lambda^2 Q(z); $$

									for any  \(\lambda \in k, z \in E\).</p>


									<p>	The reader can prove that for a given qudratic form \(Q\), the associated form \(\langle~,~ \rangle: E\times E \to k\) given by the polarization formula
$$
  \langle x,y\rangle = \frac{1}{2}(Q(x+y)-Q(x)-Q(y))  
$$
is a symmetric biliear form. </p>


<p>Given a quadratic form, \(x,y\in E\) are called <bold>orthogonal</bold> if \(\langle x,y\rangle = 0\). Linear subspaces \(U,V\) of \(E\) are <bold>orthogonal</bold> if \(\langle u,v\rangle = 0\) for all \(u\in U, v\in V\).  For a given linear subspace \(U\), the <bold>total orthogonal subspace</bold> \(U^{\perp }\) is given by 
$$
U^{\perp}  = \{e \in E \ |\ \langle e,u \rangle = 0, \text{ for all } u \in U\}.
$$
The form \(Q\) is <bold>non-singular</bold> if \(E^{\perp} = 0\).</p>

<p>Let \(Q\) be a quadratic form on \(\mathbb{R}^n\). A proof by induction shows that there exists an orthonormal basis for \(E\), i.e. a basis \(\{e_1,e_2,\cdots,e_n\}\) with 
	$$
	\langle e_i,e_j\rangle = 
	\begin{cases}
	0 &i\neq j;\\
	-1,0,1 & i = j.
	\end{cases}
	$$</p>

<p>
	We're set to state the famed <bold>Sylvester’s Theorem</bold>. For any orthonormal basis \(\{e_1,\cdots, e_n\}\) for a quadratic form \(Q\) over \(E= \mathbb{R}^n\), the numbers 
	$$
	\begin{align*}
	p &= \left \vert \{i \ \vert\  \langle e_i,e_i \rangle = -1\} \right \vert \\
	q  &=  \left \vert \{i \ \vert\ \langle e_i,e_i \rangle  =1\} \right \vert
	\end{align*}
	$$
	are constant, independent of the basis considered. 
	</p>

								</infobox>
								<p> </p>

								<p>Take a break, catch your breath. The <bold>hyperbolic space</bold> is already in sight. It's just another metric space, meaning it takes a set of points and assigns distances to each pair of them in a way that makes sense. The actual definition is a one-liner but the proof takes efforts, which we have been omitting anyway.</p>
								<infobox>

									<p>As before let us consider \(F\) to be \(\mathbb{R}^{n+1}\) equipped with a quadratic form of Sylvester type \((-n,1)\). The hyperboloid \(S(F)\) is just the set of points with norm 1. It turns out \(S(F)\) has two connected components, and we will denote \(H^n\) to be either one of them.</p>
									<p>We then define our metric on the hyperboloid to be 
										$$
										\cosh d(P,Q) = \langle P,Q\rangle, \qquad P,Q\in H^n
										$$
										This makes sense since \(\langle P,Q\rangle \geq 1\). The metric is clearly symmetrical in \(P\) and \(Q\). For \(P\neq Q\) we have that \(\langle P,Q\rangle >1\) and \(d(P,Q) >0\). The reader is welcome to prove the triangular inequality.</p>
								</infobox>

								<p></p>
<p>I suppose I've lost most of you at this point. Let's keep on anyways. We'll do some extras by defining the 'rays' for our raymarching algorithm. 			</p>					
								<p></p>

<infobox>						

								<p>
									In a metric space \(M\), a curve \(\gamma: I\to M\) where \(I\) is an interval in \(\mathbb{R}\) is a geodesic if 
									$$
									d(\gamma(s),\gamma(t)) = \vert s-t\vert
									$$
									for any \(s,t \in I\).

									
								</p>

<p>
								Any geodesic curve \(\gamma:\mathbb{R}\to H^n\) can be written in the form 
								$$
								\gamma(t) = A \cosh t +T\sinh t, \qquad t\in \mathbb{R}
								$$
								where \(A \in H^n\) and \(T\) is a unit tangent vector to \(H^n\) at \(A\).
							</p>
							</infobox>			

<p></p>

<p>If you play games at all, you'd probably heard of raytracing. Raytracing and its variant spheretracing, is a way of detecting geometric shapes in 3D and recording the information on 2D 'lens'. It's surprisingly intuitive and the basic mechanism could be contained on one single page. Here are two famous illustrations.</p>

<div class="box alt">
	<div class="row gtr-uniform">
		<div class="col-6"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/appel.png" alt="" /></span></div>
		<div class="col-6"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/wikirtx.png" alt="" /></span></div>
	</div>
</div>
<p>Spheretracing expands this idea by a signed distance function, which returns the minimal distance from a certain point to any geometric shapes in the scene. </p>
<div class="box alt">
	<div class="row gtr-uniform">
		<div class="col-8"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/sdf.jpg" alt="" /></span></div>
	</div>
</div>
<p>This has two implications. First we can 'march' step by step into the scene without accidentally bumping into anything, as guranteed by the SDF.</p> 
<div class="box alt">
	<div class="row gtr-uniform">
		<div class="col-8"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/racymarch2.png" alt="" /></span></div>
	</div>
</div>

<p>Secondly we can calculate the surface normals by the gradient of SDF!</p>

<div class="box alt">
	<div class="row gtr-uniform">
		<div class="col-8"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/raymarch4.png" alt="" /></span></div>
	</div>
</div>

<p>The downside is that it's prone to numerical errors. Not that I do not appreciate green sunrise on the striped desert. </p>
<div class="box alt">
	<div class="row gtr-uniform">
		<div class="col-8"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/bug3.png" alt="" /></span></div>
	</div>
</div>

<p>Alright, now apply everything you've learned about spheretracing to the hyperbolic space. The last piece of the puzzle is some realistic lighting.</p>

<p>We'll use the classic Phong shading. Essentially Lighting information is divided into ambient, diffuse and specular. </p>

<div class="box alt">
	<div class="row gtr-uniform">
		<div class="col-3"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/ambient.png" alt="" /></span></div>
		<div class="col-3"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/diffuse.png" alt="" /></span></div>
		<div class="col-3"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/specular.png" alt="" /></span></div>
		<div class="col-3"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/combined.png" alt="" /></span></div>
	</div>
</div>

<p>Now we can do whatever we want with the space, even generating a maze! See the picture below, you'll find five rooms centered around the same corner instead of four.</p>
<div class="box alt">
	<div class="row gtr-uniform">
		<div class="col-8"><span class="image zoom"><img src="images/code_graphics_hyperbolic_raymarching/flat_maze.png" alt="" /></span></div>
	</div>
</div>

<p>Finally the code as promised. </p>

<p><bold> ⬇ ⬇ ⬇ OPEN WITH CAUTION! IT MIGHT CRASH YOUR BROWSER! ⬇ ⬇ ⬇ </bold> </p>


<p><a href="https://qwertyqwh.github.io/Raymarching-Hyperbolic-Geometry"> https://qwertyqwh.github.io/Raymarching-Hyperbolic-Geometry/</a></p>

								<footer>

									<ul class="stats">
										<li><a href="../code.html">Code</a>&nbsp <a href="../../play/game/first_game.html">Previous Post</a>  &nbsp  <a href="../../doodle/animation/doodle_animation_pianist.html">Next Post</a> <br /> </li>
									</ul>
								</footer>
							</article>

					</div>

				<!-- Footer -->
					<section id="footer">
						<p class="copyright">&copy; QWH</p>
					</section>

			</div>

		<!-- Scripts -->
			<script src="../../assets/js/jquery.min.js"></script>
			<script src="../../assets/js/browser.min.js"></script>
			<script src="../../assets/js/breakpoints.min.js"></script>
			<script src="../../assets/js/util.js"></script>
			<script src="../../assets/js/main.js"></script>
			<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

	</body>
</html>